# 7957_Devils_StairCase
/* Minkowski's question-mark function */ double minkowski(double x) {         long p=x; if ((double)p>x) --p; /* p=floor(x) */         long q=1, r=p+1, s=1, m, n;         double d=1, y=p;         if (x&lt;(double)p||(p&lt;0)^(r&lt;=0)) return x; /* out of range ?(x) =~ x */         for (;;) /* invariants: q*r-p*s==1 &amp;&amp; (double)p/q &lt;= x &amp;&amp; x &lt; (double)r/s */         {                 d/=2; if (y+d==y) break; /* reached max possible precision */                 m=p+r; if ((m&lt;0)^(p&lt;0)) break; /* sum overflowed */                 n=q+s; if (n&lt;0) break; /* sum overflowed */                   if (x&lt;(double)m/n) r=m, s=n;                 else y+=d, p=m, q=n;         }         return y+d; /* final round-off */ }
